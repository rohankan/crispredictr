from Bio import pairwise2 as pw2
import sys
from Bio.Align.Applications import MafftCommandline
import tempfile


def global_alignment(seq1: str,
                     seq2: str,
                     match: int = 3,
                     mismatch: int = -2,
                     gap_init: int = -7,
                     gap_extend: int = -2):
    align1, align2, *_ = pw2.align.globalms(
        seq1, seq2, match, mismatch, gap_init, gap_extend, one_alignment_only=True
    )[0]

    return align1, align2


sequences = [
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGGCCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACCCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGCGCCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAACGACCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACACCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCACCTCCTCAGGTGCCTCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGGGAGGTCCCTGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCACCTCCTCAGGTGCCTCCACAACGTGGAGTCCCCGCGTGGAAGCCCCGCAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCGAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCCTCCGC',
    'GCTCCCGCCGGTGCGCGCTCCTCAGGTGCCTCCACAGGTCCCCGCGTGGAAGCCCGGGCCGCGGCCTCCGC'
]


# for seq1, seq2 in zip(sequences, sequences[1:]):
#     align1, align2 = global_alignment(seq1, seq2)
#     print(align1)
#     print(align2)
#     break


lines = sequences

with tempfile.NamedTemporaryFile() as temp:
    temp.write(bytes('\n'.join(lines), encoding='utf8'))
    temp.seek(0)
    mafft_cline = MafftCommandline(input=temp.name)
    stdout, stderr = mafft_cline()

print(stdout, stderr)
